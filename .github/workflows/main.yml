name: 24/7 Professional SMM Watchtime
on:
  schedule:
    - cron: "0 */6 * * *"  # Har 6 ghante baad khud restart hoga
  workflow_dispatch:

jobs:
  build:
    runs-on: windows-latest
    timeout-minutes: 9999
    steps:
      - name: Setup RDP & Cloudflare
        run: |
          # Download Cloudflare
          Invoke-WebRequest -Uri "https://github.com/cloudflare/cloudflared/releases/latest/download/cloudflared-windows-amd64.exe" -OutFile "cloudflared.exe"
          
          # Create SMM User
          net user SMMExpert Pass123 /add
          net localgroup "Remote Desktop Users" SMMExpert /add
          net localgroup "Administrators" SMMExpert /add
          
          # Enable RDP
          Set-ItemProperty -Path 'HKLM:\System\CurrentControlSet\Control\Terminal Server' -Name "fDenyTSConnections" -Value 0
          
          # Start Tunnel
          Start-Process "./cloudflared.exe" -ArgumentList "tunnel --url rdp://localhost:3389"
          
      - name: Auto-Start Chrome & Watchtime
        run: |
          $PlaylistURL = "https://youtube.com/playlist?list=PL4nAU-8Arfz_ifcf_FzeQSCRVyawBdS5z"
          
          # 3 Profiles Setup for 3 Gmails
          for ($i=1; $i -le 3; $i++) {
            $UserDir = "C:\SMM_Profiles\Profile_$i"
            
            # Start Chrome with Bypass Flags
            Start-Process "chrome.exe" -ArgumentList @(
                "--url=$PlaylistURL",
                "--user-data-dir=$UserDir",
                "--disable-blink-features=AutomationControlled",
                "--no-sandbox",
                "--mute-audio",
                "--disable-background-timer-throttling",
                "--start-maximized"
            )
            Write-Host "Profile $i Started Automatically."
            Start-Sleep -Seconds 15
          }
          
          # Keep the machine alive for 15+ hours
          Start-Sleep -Seconds 54000 
        shell: powershell
