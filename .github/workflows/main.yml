import time
import undetected_chromedriver as uc

def start_smm_viewer(profile_path, playlist_url):
    try:
        options = uc.ChromeOptions()
        options.add_argument(f"--user-data-dir={profile_path}")
        options.add_argument("--mute-audio")
        # Purani detach wali line hata di hai taake error na aaye
        options.add_argument("--disable-blink-features=AutomationControlled")

        driver = uc.Chrome(options=options)
        driver.get(playlist_url)
        print(f"Successfully started Profile: {profile_path}")
        
        time.sleep(10)
        driver.execute_script('''
            var video = document.getElementsByTagName("video")[0];
            if(video){
                video.playbackRate = 0.25;
                video.loop = true;
            }
            // Playlist loop button activate karna
            var loopBtn = document.querySelector('button[aria-label="Loop playlist"]');
            if(loopBtn) loopBtn.click();
        ''')
        return driver # Driver ko return karna zaroori hai taake browser band na ho
    except Exception as e:
        print(f"Error: {e}")
        return None

my_playlist = "https://youtube.com/playlist?list=PL4nAU-8Arfz_ifcf_FzeQSCRVyawBdS5z&si=8DYKF3Bg67SAoov8"
profiles = ["C:/SMM_Profile_1", "C:/SMM_Profile_2", "C:/SMM_Profile_3"]

# Drivers ko list mein rakhna taake wo memory mein rahen aur browser band na ho
active_drivers = []

for p in profiles:
    d = start_smm_viewer(p, my_playlist)
    if d:
        active_drivers.append(d)

print("\n--- ALL PROFILES RUNNING ---")
print("PowerShell ki window band mat kijiyega, warna browser band ho jayenge.")
input("Press Enter ONLY to stop the watchtime...")
