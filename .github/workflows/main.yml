- name: Setup RDP & Cloudflare
        run: |
          # 1. Cloudflare Download
          Invoke-WebRequest -Uri "https://github.com/cloudflare/cloudflared/releases/latest/download/cloudflared-windows-amd64.exe" -OutFile "cloudflared.exe"
          
          # 2. RDP User Setup
          net user SMMExpert Pass123 /add
          net localgroup "Remote Desktop Users" SMMExpert /add
          net localgroup "Administrators" SMMExpert /add
          Set-ItemProperty -Path 'HKLM:\System\CurrentControlSet\Control\Terminal Server' -Name "fDenyTSConnections" -Value 0
          
          # 3. Tunnel Start (Link ko capture karne ke liye)
          Write-Host "Generating RDP Link... Please wait 30 seconds."
          Start-Process "./cloudflared.exe" -ArgumentList "tunnel --url rdp://localhost:3389" -RedirectStandardError "link.txt"
          
          # 4. Wait for link generation
          Start-Sleep -Seconds 35
          
          # 5. Forcefully print the link in logs
          $content = Get-Content "link.txt"
          foreach($line in $content) {
            if($line -match "trycloudflare.com") {
              Write-Host "====================================" -ForegroundColor Cyan
              Write-Host "YOUR RDP LINK IS: $line" -ForegroundColor Green
              Write-Host "====================================" -ForegroundColor Cyan
            }
          }
