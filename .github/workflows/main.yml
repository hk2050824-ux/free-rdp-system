name: 15Hour-NonStop-Watchtime
on:
  schedule:
    - cron: "0 */6 * * *"  # Har 6 ghante baad auto-restart
  workflow_dispatch:

jobs:
  build:
    runs-on: windows-latest
    timeout-minutes: 9999
    steps:
      - name: Setup RDP & Cloudflare
        run: |
          # Cloudflare download aur RDP setup
          Invoke-WebRequest -Uri "https://github.com/cloudflare/cloudflared/releases/latest/download/cloudflared-windows-amd64.exe" -OutFile "cloudflared.exe"
          net user SMMExpert Pass123 /add
          net localgroup "Remote Desktop Users" SMMExpert /add
          net localgroup "Administrators" SMMExpert /add
          Set-ItemProperty -Path 'HKLM:\System\CurrentControlSet\Control\Terminal Server' -Name "fDenyTSConnections" -Value 0
          Start-Process "./cloudflared.exe" -ArgumentList "tunnel --url rdp://localhost:3389"
          
      - name: Automated-Watchtime-Engine
        run: |
          $PlaylistURL = "https://youtube.com/playlist?list=PL4nAU-8Arfz_ifcf_FzeQSCRVyawBdS5z"
          
          # 3 Profiles with persistence logic
          for ($i=1; $i -le 3; $i++) {
            $UserDir = "C:\SMM_Profiles\Profile_$i"
            Start-Process "chrome.exe" -ArgumentList @(
                "--url=$PlaylistURL",
                "--user-data-dir=$UserDir",
                "--disable-blink-features=AutomationControlled",
                "--no-sandbox",
                "--mute-audio",
                "--disable-background-timer-throttling"
            )
            Write-Host "Profile $i is now running in background."
            Start-Sleep -Seconds 15
          }
          
          # Machine ko 15 ghante (54000 seconds) tak zinda rakhne ke liye
          Start-Sleep -Seconds 54000 
        shell: powershell
